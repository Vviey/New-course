import{c as m,j as e,k as T,a as q,u as O,g as G,X as J,l as X}from"./index-Cb9N_GOt.js";import{r}from"./react-Q3K9tvtn.js";import{B as t}from"./button-DIUnBPwv.js";import{C as d,b as h,c as z,d as E,e as L,a as f}from"./card-BVRRBF6E.js";import{A as K}from"./arrow-left-Cc1Sbg4I.js";import{B as Q}from"./bookmark-aLyi4X8E.js";import{B as W}from"./book-Bg6Fkw_p.js";import{C as Z}from"./clock-BqnukmBP.js";import{C as _}from"./chevron-right-DQMAqhsF.js";import"./index-CrZBFJ1p.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=m("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=m("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=m("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=m("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),A=r.forwardRef(({className:l,type:a,...i},o)=>e.jsx("input",{type:a,className:T("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",l),ref:o,...i}));A.displayName="Input";const p=r.forwardRef(({className:l,...a},i)=>e.jsx("textarea",{className:T("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",l),ref:i,...a}));p.displayName="Textarea";const xe=()=>{const{user:l,userProfile:a,updateProfile:i,backpack:o,removeFromBackpack:H,updateBackpackItem:D,currentRealm:j,logout:P}=q(),[,n]=O(),{toast:v}=X(),[g,b]=r.useState(!1),[N,k]=r.useState((a==null?void 0:a.bio)||""),[x,y]=r.useState((a==null?void 0:a.avatarColor)||"#ffcc00"),[C,u]=r.useState(null),[w,I]=r.useState("");r.useEffect(()=>{a&&(k(a.bio||""),y(a.avatarColor||"#ffcc00"))},[a]);const V=G(j);if(!l||!a)return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:e.jsxs(d,{className:"w-full max-w-md",children:[e.jsxs(h,{children:[e.jsx(z,{children:"Not Logged In"}),e.jsx(E,{children:"Please log in to view your profile"})]}),e.jsx(L,{children:e.jsx(t,{onClick:()=>n("/auth"),children:"Log In"})})]})});const Y=()=>{i({bio:N,avatarColor:x}),b(!1),v({title:"Profile Updated",description:"Your profile information has been saved."})},F=s=>{const c=o.find($=>$.id===s);c&&(u(s),I(c.notes||""))},U=s=>{D(s,{notes:w}),u(null),v({title:"Note Saved",description:"Your notes have been updated."})},S=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),B=a.username.charAt(0).toUpperCase();return e.jsx("div",{className:"min-h-screen bg-background pt-16 pb-24",children:e.jsxs("div",{className:"container px-4 mx-auto max-w-4xl",children:[e.jsxs(t,{variant:"ghost",size:"sm",className:"mb-4",onClick:()=>n(`/realm/${j}`),children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Back to Realm"]}),e.jsxs(d,{className:"mb-8",children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-2xl font-bold mr-4",style:{backgroundColor:a.avatarColor||"#ffcc00"},children:B}),e.jsxs("div",{children:[e.jsx(z,{className:"text-2xl",children:a.username}),e.jsxs(E,{children:["Joined ",S(a.joinDate)]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[g?e.jsxs(t,{onClick:Y,size:"sm",children:[e.jsx(M,{className:"h-4 w-4 mr-1"}),"Save"]}):e.jsxs(t,{onClick:()=>b(!0),variant:"outline",size:"sm",children:[e.jsx(R,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(t,{variant:"destructive",size:"sm",onClick:()=>{P(),n("/auth")},children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),"Logout"]})]})]})}),e.jsx(f,{children:g?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Avatar Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{type:"color",value:x,onChange:s=>y(s.target.value),className:"w-12 h-8 p-1"}),e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:x},children:B})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bio"}),e.jsx(p,{value:N,onChange:s=>k(s.target.value),placeholder:"Tell us about yourself...",className:"w-full",rows:4})]})]}):e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"About"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:a.bio||"No bio provided. Click 'Edit' to add one."})]})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Q,{className:"h-6 w-6 mr-2",style:{color:V.colors.primary}}),e.jsx("h2",{className:"text-xl font-bold",children:"Your Backpack"})]}),o.length===0?e.jsx(d,{children:e.jsx(f,{className:"py-8",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Your backpack is empty. Highlight important content during missions to save it here."})})}):e.jsx("div",{className:"space-y-4",children:o.map(s=>e.jsxs(d,{className:"overflow-hidden",children:[e.jsx("div",{className:"h-2",style:{backgroundColor:s.color||"#ffcc00"}}),e.jsx(h,{className:"py-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsxs("span",{className:"text-sm font-medium",children:["Realm ",s.realmId," â€¢ Mission ",s.missionId]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"h-4 w-4 mr-1 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:S(s.timestamp)})]})]})}),e.jsxs(f,{className:"py-2",children:[e.jsx("div",{className:"py-2 px-3 rounded-md bg-muted/50 font-mono text-sm",children:s.text}),C===s.id?e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Your Notes"}),e.jsx(p,{value:w,onChange:c=>I(c.target.value),placeholder:"Add your notes about this highlight...",className:"w-full",rows:3}),e.jsxs("div",{className:"flex justify-end mt-2 gap-2",children:[e.jsxs(t,{size:"sm",variant:"ghost",onClick:()=>u(null),children:[e.jsx(J,{className:"h-4 w-4 mr-1"}),"Cancel"]}),e.jsxs(t,{size:"sm",onClick:()=>U(s.id),children:[e.jsx(M,{className:"h-4 w-4 mr-1"}),"Save Notes"]})]})]}):e.jsx(e.Fragment,{children:s.notes&&e.jsx("div",{className:"mt-3 p-3 border-l-2 border-primary/30 text-sm",children:e.jsx("p",{className:"text-muted-foreground italic",children:s.notes})})})]}),e.jsxs(L,{className:"py-2 px-6 bg-muted/20 flex justify-between",children:[e.jsxs(t,{variant:"ghost",size:"sm",onClick:()=>n(`/realm/${s.realmId}/mission/${s.missionId}`),children:["Go to Source",e.jsx(_,{className:"h-4 w-4 ml-1"})]}),e.jsxs("div",{className:"flex gap-2",children:[C!==s.id&&e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>F(s.id),children:[e.jsx(R,{className:"h-4 w-4 mr-1"}),"Add Note"]}),e.jsxs(t,{variant:"destructive",size:"sm",onClick:()=>H(s.id),children:[e.jsx(se,{className:"h-4 w-4 mr-1"}),"Remove"]})]})]})]},s.id))})]})]})})};export{xe as default};
