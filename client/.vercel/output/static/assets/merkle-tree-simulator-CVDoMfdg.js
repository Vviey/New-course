import{j as e,p as r}from"./index-Cb9N_GOt.js";import{r as c}from"./react-Q3K9tvtn.js";import{H as C}from"./hash-XwdJaU6w.js";import{R as w}from"./refresh-cw-C2iCUXhH.js";import{G as M}from"./git-merge-BTcJA1zp.js";function L({onComplete:j}){const[a,N]=c.useState([{id:1,data:"Alice sends 1 BTC to Bob",included:!0},{id:2,data:"Bob sends 0.5 BTC to Charlie",included:!0},{id:3,data:"Dave sends 2 BTC to Alice",included:!0},{id:4,data:"Charlie sends 0.2 BTC to Dave",included:!0}]),[g,d]=c.useState(""),[x,m]=c.useState(null),[i,b]=c.useState({status:"",message:"",complete:!1}),[u,h]=c.useState(!1),n=s=>{let t=0;for(let l=0;l<s.length;l++){const o=s.charCodeAt(l);t=(t<<5)-t+o,t=t&t}return Math.abs(t).toString(16).padStart(6,"0")},f=()=>{h(!0);const s=a.filter(l=>l.included);if(s.length===0){m(null),d(""),h(!1);return}let t=s.map(l=>({hash:n(l.data),isLeaf:!0,data:l.data,highlight:!1}));for(t.length%2!==0&&t.push({...t[t.length-1]});t.length>1;){const l=[];for(let o=0;o<t.length;o+=2){const p=t[o],y=t[o+1],T=n(p.hash+y.hash);l.push({hash:T,isLeaf:!1,left:p,right:y,highlight:!1})}t=l}setTimeout(()=>{m(t[0]),d(t[0].hash),h(!1)},800)},k=s=>{x&&(b({status:"verifying",message:`Verifying transaction: ${a[s].data}...`,complete:!1}),setTimeout(()=>{b({status:"success",message:`Transaction verified! It's included in block with Merkle root: ${g}`,complete:!0}),setTimeout(j,2e3)},1500))},v=s=>{N(a.map(t=>t.id===s?{...t,included:!t.included}:t))};return c.useEffect(()=>{a.some(s=>s.included)?f():(m(null),d(""))},[a]),e.jsxs("div",{className:"py-6",children:[e.jsxs("div",{className:"mb-8 p-6 rounded-lg",style:{backgroundColor:"rgba(8, 28, 36, 0.6)"},children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:r.colors.primary},children:"Merkle Tree Challenge"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Merkle trees allow Bitcoin to efficiently and securely organize transaction data. This structure makes it possible to verify if a transaction is included in a block without downloading the entire blockchain."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-black/30 p-4 rounded-md",children:[e.jsx("h4",{className:"text-sm font-semibold mb-3",style:{color:r.colors.secondary},children:"Transactions in Block:"}),e.jsx("div",{className:"grid gap-3",children:a.map(s=>e.jsxs("div",{className:`p-3 rounded-md flex items-center justify-between transition-all ${s.included?"opacity-100":"opacity-50"}`,style:{backgroundColor:s.included?"rgba(6, 214, 160, 0.1)":"rgba(6, 214, 160, 0.05)",borderLeft:s.included?`3px solid ${r.colors.primary}`:"3px solid transparent"},children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-2",style:{color:r.colors.accent1}}),e.jsxs("span",{className:"text-sm text-gray-300",children:["TX",s.id,": ",s.data]})]}),s.included&&e.jsxs("div",{className:"mt-1 text-xs font-mono",style:{color:r.colors.accent2},children:["Hash: ",n(s.data)]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>v(s.id),className:"text-xs px-2 py-1 rounded",style:{backgroundColor:s.included?"rgba(239, 68, 68, 0.2)":"rgba(6, 214, 160, 0.2)",color:s.included?"#f87171":r.colors.primary},children:s.included?"Remove":"Include"}),s.included&&!i.complete&&e.jsx("button",{onClick:()=>k(s.id-1),className:"text-xs px-2 py-1 rounded",style:{backgroundColor:"rgba(6, 214, 160, 0.2)",color:r.colors.primary},children:"Verify"})]})]},s.id))})]}),e.jsxs("div",{className:"bg-black/20 p-4 rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"text-sm font-semibold",style:{color:r.colors.secondary},children:"Merkle Tree Structure:"}),e.jsx("button",{onClick:f,disabled:!a.some(s=>s.included)||u,className:"px-3 py-1 text-xs rounded text-white font-medium flex items-center",style:{backgroundColor:r.colors.primary,opacity:!a.some(s=>s.included)||u?.7:1},children:u?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"mr-1 h-3 w-3 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"mr-1 h-3 w-3"}),"Rebuild Tree"]})})]}),x?e.jsx("div",{className:"p-3 bg-black/30 rounded-md",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"inline-block px-4 py-2 rounded-md mb-3",style:{backgroundColor:"rgba(6, 214, 160, 0.2)",border:`1px solid ${r.colors.primary}`},children:[e.jsx("div",{className:"text-xs",style:{color:r.colors.secondary},children:"Merkle Root"}),e.jsx("div",{className:"font-mono text-sm",style:{color:r.colors.primary},children:g})]}),e.jsx("div",{className:"text-xs text-gray-400 mt-2 mb-4",children:"This is added to the block header, allowing efficient verification of any transaction in the block."}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3",children:a.filter(s=>s.included).map(s=>e.jsxs("div",{className:"p-2 text-xs font-mono rounded bg-black/20",style:{color:r.colors.accent2},children:["Leaf: ",n(s.data)]},s.id))})]})}):e.jsx("div",{className:"p-6 text-center text-gray-500 bg-black/20 rounded-md",children:a.some(s=>s.included)?"Generating tree...":"Include some transactions to generate the Merkle tree"})]})]}),i.status&&e.jsx("div",{className:`mt-6 p-3 rounded-md ${i.status==="success"?"bg-green-900/30":i.status==="error"?"bg-red-900/30":"bg-blue-900/30"}`,style:{borderLeft:`4px solid ${i.status==="success"?"#10b981":i.status==="error"?"#ef4444":"#3b82f6"}`},children:e.jsx("p",{className:i.status==="success"?"text-green-400":i.status==="error"?"text-red-400":"text-blue-400",children:i.message})})]}),i.complete&&e.jsxs("div",{className:"text-center p-4 rounded-lg border",style:{backgroundColor:"rgba(6, 214, 160, 0.1)",borderColor:`${r.colors.primary}40`},children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:r.colors.primary},children:"Challenge Complete!"}),e.jsx("p",{className:"text-gray-300",children:"Well done! You've experienced how Merkle trees enable efficient verification of data in Bitcoin. This technology allows lightweight clients to verify transactions without downloading the entire blockchain."})]})]})}export{L as default};
