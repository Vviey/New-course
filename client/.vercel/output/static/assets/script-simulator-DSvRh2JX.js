import{c as q,j as e,p as l,S as M}from"./index-Cb9N_GOt.js";import{r as n}from"./react-Q3K9tvtn.js";import{R as w}from"./refresh-cw-C2iCUXhH.js";import{L as $}from"./lock-DhB5_l0_.js";import{C as W}from"./code-C6fYCasi.js";import{L as G}from"./lock-open-DhJzDle9.js";import{C as E}from"./cpu-DO-7ugSt.js";import{C as Q}from"./check-KWJc-uHV.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=q("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);function ne({onComplete:_}){const[a,y]=n.useState(1),[g,j]=n.useState({locked:!0,puzzle:"",solution:""}),[b,C]=n.useState([]),[u,z]=n.useState([]),[x,f]=n.useState([]),[P,N]=n.useState([]),[c,k]=n.useState(0),[m,T]=n.useState(null),[I,K]=n.useState({publicKey:"",signature:"",pubKeyHash:""}),[p,H]=n.useState({completed:!1,message:"",success:!1}),[i,h]=n.useState(!1),[J,F]=n.useState(!0),B=()=>{const s="PublicKey_"+Math.random().toString(16).substring(2,10),t="Signature_"+Math.random().toString(16).substring(2,10),r="Hash_"+Math.random().toString(16).substring(2,8);return{publicKey:s,signature:t,pubKeyHash:r}},O=s=>s==="True"?"✅ True":s==="False"?"❌ False":s.startsWith("Hash_")?`🔗 ${s}`:s.startsWith("PublicKey_")?`🔑 ${s}`:s.startsWith("Signature_")?`✍️ ${s}`:s,R=()=>{h(!0),setTimeout(()=>{j({locked:!0,puzzle:"Provide the key that matches this lock pattern",solution:"The correct key with matching teeth"}),y(2),h(!1)},800)},A=()=>{h(!0),setTimeout(()=>{const s=B();K(s);const t=["OP_DUP","OP_HASH160",s.pubKeyHash,"OP_EQUALVERIFY","OP_CHECKSIG"],r=[s.signature,s.publicKey];C(t),z(r),j({locked:!1,puzzle:"Mathematical proof of ownership required",solution:"Signature + Public Key that matches the puzzle"}),y(3),h(!1)},800)},D=()=>{c===0?(f([]),N([]),k(1),h(!0),setTimeout(()=>{L()},500)):L()},L=()=>{const s=[...u,...b];if(c>s.length){const d=x.length>0&&x[x.length-1]==="True";T({valid:d,message:d?"Script execution successful! The treasure chest unlocks! 🎉":"Script execution failed! The treasure chest remains locked! 🔒"}),d&&(y(4),H({completed:!0,message:"Congratulations! You've mastered Bitcoin Script operations and unlocked the treasure!",success:!0}),setTimeout(_,2e3)),h(!1);return}const t=s[c-1],r=[...x];let o="",v="";if(c<=u.length)v=`ScriptSig Step ${c}`,r.push(t),o=`Push "${t}" onto the stack`;else switch(v=`ScriptPubKey Step ${c-u.length}`,t){case"OP_DUP":if(r.length>0){const S=r[r.length-1];r.push(S),o="Duplicate the top item on the stack"}break;case"OP_HASH160":r.length>0&&(r.pop(),r.push(I.pubKeyHash),o="Hash the public key and push result to stack");break;case"OP_EQUALVERIFY":if(r.length>=2){const S=r.pop(),V=r.pop();S===V?o="Verify hashes are equal ✅ - Continue execution":(r.push("False"),o="Hashes not equal ❌ - Script fails")}break;case"OP_CHECKSIG":r.length>=2&&(r.pop(),r.pop(),r.push("True"),o="Verify signature with public key ✅ - Push True");break;default:r.push(t),o=`Push "${t}" onto the stack`}const Y={step:v,stack:[...r],operation:t,description:o};f(r),N(d=>[...d,Y]),k(d=>d+1),setTimeout(()=>{h(!1)},800)},U=()=>{y(1),j({locked:!0,puzzle:"",solution:""}),C([]),z([]),f([]),N([]),k(0),T(null),K({publicKey:"",signature:"",pubKeyHash:""}),H({completed:!1,message:"",success:!1}),F(!0)};return e.jsxs("div",{className:"py-6",children:[e.jsxs("div",{className:"mb-8 p-6 rounded-lg",style:{backgroundColor:"rgba(8, 28, 36, 0.6)"},children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:l.colors.primary},children:"Bitcoin Script Challenge: The Digital Treasure Chest"}),e.jsx("p",{className:"text-gray-300 mb-4",children:'Learn how Bitcoin Script works like a puzzle that must be solved to unlock digital treasure. Bitcoin Script is the "rulebook" that defines exactly how coins can be spent.'}),e.jsxs("div",{className:"mb-6 p-4 rounded-lg",style:{backgroundColor:"rgba(6, 214, 160, 0.1)"},children:[e.jsx("h4",{className:"font-semibold mb-3",style:{color:l.colors.primary},children:"💡 What is Bitcoin Script?"}),e.jsxs("div",{className:"text-sm text-gray-300 space-y-2",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Rulebook:"})," Bitcoin Script defines WHO can spend a coin and HOW"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Security First:"})," Intentionally limited (not Turing-complete) to prevent attacks"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Mathematical Proof:"}),' You must solve the "puzzle" to prove you own the coins']}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Two Parts:"})," Locking script (the puzzle) + Unlocking script (your solution)"]})]})]}),e.jsxs("div",{className:`space-y-4 mb-6 p-4 rounded-lg ${a>=1?"bg-black/20":"bg-black/10 opacity-50"}`,children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("span",{className:`w-8 h-8 rounded-full flex items-center justify-center mr-3 text-sm font-bold ${a>=1?"text-white":"text-gray-500"}`,style:{backgroundColor:a>=1?l.colors.primary:"#6b7280"},children:"1"}),e.jsx("h4",{className:"text-lg font-semibold",style:{color:l.colors.secondary},children:"The Treasure Chest Analogy"})]}),e.jsx("p",{className:"text-gray-300 text-sm mb-4",children:"Imagine Bitcoin as a digital treasure chest. The treasure chest has a special lock with a puzzle. Only someone who can solve the puzzle can open the chest and claim the treasure inside."}),e.jsx("button",{onClick:R,disabled:i,className:"px-4 py-2 rounded text-white font-medium flex items-center text-sm mb-4",style:{backgroundColor:l.colors.primary,opacity:i?.7:1},children:i?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Treasure..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Create Digital Treasure Chest"]})}),g.puzzle&&e.jsx("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(255, 215, 0, 0.1)"},children:e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"text-6xl mb-2",children:g.locked?"🔒":"🔓"}),e.jsx("h5",{className:"font-semibold text-yellow-400 mb-2",children:"Digital Treasure Chest"}),e.jsxs("div",{className:"text-sm text-gray-300",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"})," ",g.locked?"Locked":"Ready to Unlock"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Puzzle:"})," ",g.puzzle]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Solution Required:"})," ",g.solution]})]})]})})]}),e.jsxs("div",{className:`space-y-4 mb-6 p-4 rounded-lg ${a>=2?"bg-black/20":"bg-black/10 opacity-50"}`,children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("span",{className:`w-8 h-8 rounded-full flex items-center justify-center mr-3 text-sm font-bold ${a>=2?"text-white":"text-gray-500"}`,style:{backgroundColor:a>=2?l.colors.primary:"#6b7280"},children:"2"}),e.jsx("h4",{className:"text-lg font-semibold",style:{color:l.colors.secondary},children:"Create the Puzzle Scripts"})]}),e.jsxs("p",{className:"text-gray-300 text-sm mb-4",children:["Now we'll create the actual Bitcoin scripts. The ",e.jsx("strong",{children:"ScriptPubKey"})," is the puzzle (locking script), and the ",e.jsx("strong",{children:"ScriptSig"})," is your solution attempt (unlocking script)."]}),e.jsx("button",{onClick:A,disabled:a<2||i,className:"px-4 py-2 rounded text-white font-medium flex items-center text-sm mb-4",style:{backgroundColor:a>=2?l.colors.primary:"#6b7280",opacity:a<2||i?.7:1},children:i?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Scripts..."]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Generate Scripts"]})}),b.length>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(255, 165, 0, 0.1)"},children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx($,{className:"h-5 w-5 text-yellow-400 mr-2"}),e.jsx("h5",{className:"font-semibold text-yellow-400",children:"ScriptPubKey (The Puzzle)"})]}),e.jsx("div",{className:"space-y-2",children:b.map((s,t)=>e.jsxs("div",{className:"flex items-center p-2 bg-black/30 rounded text-sm",children:[e.jsx("span",{className:"w-6 h-6 bg-yellow-500 text-black rounded-full flex items-center justify-center text-xs font-bold mr-3",children:t+1}),e.jsx("span",{className:"font-mono text-yellow-300",children:s})]},t))}),e.jsx("p",{className:"text-xs text-gray-400 mt-3",children:'This is the "lock" on the treasure chest. It says: "To unlock, provide a signature and public key that hash to the stored value."'})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(6, 214, 160, 0.1)"},children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(G,{className:"h-5 w-5 text-green-400 mr-2"}),e.jsx("h5",{className:"font-semibold text-green-400",children:"ScriptSig (Your Solution)"})]}),e.jsx("div",{className:"space-y-2",children:u.map((s,t)=>e.jsxs("div",{className:"flex items-center p-2 bg-black/30 rounded text-sm",children:[e.jsx("span",{className:"w-6 h-6 bg-green-500 text-black rounded-full flex items-center justify-center text-xs font-bold mr-3",children:t+1}),e.jsx("span",{className:"font-mono text-green-300",children:s})]},t))}),e.jsx("p",{className:"text-xs text-gray-400 mt-3",children:'This is your "key" to the treasure chest. You provide your signature and public key as proof of ownership.'})]})]})]}),e.jsxs("div",{className:`space-y-4 mb-6 p-4 rounded-lg ${a>=3?"bg-black/20":"bg-black/10 opacity-50"}`,children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("span",{className:`w-8 h-8 rounded-full flex items-center justify-center mr-3 text-sm font-bold ${a>=3?"text-white":"text-gray-500"}`,style:{backgroundColor:a>=3?l.colors.primary:"#6b7280"},children:"3"}),e.jsx("h4",{className:"text-lg font-semibold",style:{color:l.colors.secondary},children:"Execute the Script (Solve the Puzzle!)"})]}),e.jsx("p",{className:"text-gray-300 text-sm mb-4",children:'Now Bitcoin will test your solution against the puzzle! It executes both scripts step-by-step using a "stack" (like a stack of papers). If the final result is "True", you solved the puzzle and can spend the coins!'}),e.jsx("button",{onClick:D,disabled:a<3||i||c>0&&c>[...u,...b].length,className:"px-4 py-2 rounded text-white font-medium flex items-center text-sm mb-4",style:{backgroundColor:a>=3?l.colors.primary:"#6b7280",opacity:a<3||i||c>0&&c>[...u,...b].length?.7:1},children:i?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"mr-2 h-4 w-4 animate-spin"}),"Executing..."]}):c===0?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Start Script Execution"]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Next Step"]})}),c>0&&e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(6, 214, 160, 0.1)"},children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(Z,{className:"h-5 w-5 text-blue-400 mr-2"}),e.jsx("h5",{className:"font-semibold text-blue-400",children:"Current Stack (Think: Stack of Papers)"})]}),e.jsx("div",{className:"min-h-[100px] border-2 border-dashed border-blue-400 rounded-lg p-3",children:x.length===0?e.jsx("div",{className:"text-gray-400 text-center italic",children:"Stack is empty"}):e.jsx("div",{className:"space-y-2",children:x.slice().reverse().map((s,t)=>e.jsxs("div",{className:`p-2 rounded text-sm font-mono ${t===0?"bg-blue-500/30 border border-blue-400":"bg-black/30"}`,children:[t===0&&e.jsx("span",{className:"text-xs text-blue-300 mr-2",children:"TOP:"}),O(s)]},t))})})]}),P.length>0&&e.jsxs("div",{className:"p-4 rounded-lg bg-black/40",children:[e.jsx("h5",{className:"font-semibold mb-3 text-gray-300",children:"📝 Execution Log:"}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:P.map((s,t)=>e.jsxs("div",{className:"p-3 bg-black/50 rounded border-l-4 border-blue-400",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"font-semibold text-blue-300",children:s.step}),e.jsx("code",{className:"text-xs text-yellow-300 bg-black/50 px-2 py-1 rounded",children:s.operation})]}),e.jsx("div",{className:"text-sm text-gray-300 mb-2",children:s.description}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Stack after: [",s.stack.map(O).join(", "),"]"]})]},t))})]}),m&&e.jsxs("div",{className:`p-4 rounded-lg ${m.valid?"bg-green-900/20 border border-green-500":"bg-red-900/20 border border-red-500"}`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[m.valid?e.jsx(Q,{className:"h-6 w-6 text-green-400 mr-3"}):e.jsx(M,{className:"h-6 w-6 text-red-400 mr-3"}),e.jsx("h5",{className:`font-semibold ${m.valid?"text-green-400":"text-red-400"}`,children:"Script Execution Complete!"})]}),e.jsx("p",{className:`text-sm ${m.valid?"text-green-300":"text-red-300"}`,children:m.message}),m.valid&&e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("div",{className:"text-6xl mb-2",children:"🎉"}),e.jsx("div",{className:"text-lg font-semibold text-green-400",children:"Treasure Unlocked!"}),e.jsx("div",{className:"text-sm text-green-300",children:"You successfully proved ownership and can spend the Bitcoin!"})]})]})]}),e.jsxs("div",{className:"mb-6 p-4 rounded-lg bg-black/30",children:[e.jsx("h4",{className:"font-semibold mb-3",style:{color:l.colors.secondary},children:"🔧 Bitcoin Script Operations Reference"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-2 bg-black/40 rounded",children:[e.jsx("span",{className:"font-mono text-yellow-300",children:"OP_DUP"}),e.jsx("div",{className:"text-gray-400 text-xs",children:"Duplicate the top item on the stack"})]}),e.jsxs("div",{className:"p-2 bg-black/40 rounded",children:[e.jsx("span",{className:"font-mono text-yellow-300",children:"OP_HASH160"}),e.jsx("div",{className:"text-gray-400 text-xs",children:"Hash the top item and push result to stack"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-2 bg-black/40 rounded",children:[e.jsx("span",{className:"font-mono text-yellow-300",children:"OP_EQUALVERIFY"}),e.jsx("div",{className:"text-gray-400 text-xs",children:"Check if top two items are equal, fail if not"})]}),e.jsxs("div",{className:"p-2 bg-black/40 rounded",children:[e.jsx("span",{className:"font-mono text-yellow-300",children:"OP_CHECKSIG"}),e.jsx("div",{className:"text-gray-400 text-xs",children:"Verify signature matches public key"})]})]})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:U,className:"px-6 py-2 rounded text-white font-medium",style:{backgroundColor:l.colors.secondary},children:"🔄 Try Another Treasure Chest"})}),p.message&&e.jsx("div",{className:`mt-6 p-3 rounded-md ${p.success?"bg-green-900/30":"bg-red-900/30"}`,style:{borderLeft:`4px solid ${p.success?"#10b981":"#ef4444"}`},children:e.jsx("p",{className:p.success?"text-green-400":"text-red-400",children:p.message})})]}),p.completed&&e.jsxs("div",{className:"text-center p-4 rounded-lg border",style:{backgroundColor:"rgba(6, 214, 160, 0.1)",borderColor:`${l.colors.primary}40`},children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:l.colors.primary},children:"Challenge Complete!"}),e.jsx("p",{className:"text-gray-300",children:`You've mastered Bitcoin Script! You now understand how Bitcoin uses programmable "puzzles" to control who can spend coins. This stack-based system ensures that only valid transactions with proper cryptographic proofs can unlock digital treasure!`})]})]})}export{ne as default};
