import{u as p,a as f,j as e,L as c}from"./index-Cb9N_GOt.js";import{r as x}from"./react-Q3K9tvtn.js";import{B as j}from"./bookmark-aLyi4X8E.js";import{B as g}from"./book-Bg6Fkw_p.js";function y({className:m=""}){const[o,a]=x.useState(!1),t=x.useRef(null),n=x.useRef(null),[,l]=p(),{backpack:r}=f(),d=()=>{a(!o)};x.useEffect(()=>{const s=i=>{t.current&&n.current&&!t.current.contains(i.target)&&!n.current.contains(i.target)&&a(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]);const h=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric"}),u=(s,i=60)=>s.length<=i?s:s.substring(0,i)+"...";return e.jsxs("div",{className:`relative ${m}`,children:[e.jsxs("button",{ref:n,className:"p-2 text-secondary hover:text-primary transition-colors relative",onClick:d,"aria-label":"Open backpack menu",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"}),e.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),e.jsx("path",{d:"M16 10a4 4 0 0 1-8 0"})]}),r.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-primary text-darkBg text-xs w-4 h-4 flex items-center justify-center rounded-full",children:r.length})]}),o&&e.jsxs("div",{ref:t,className:"backpack-menu absolute right-0 mt-2 w-80 bg-darkBg border border-secondary/20 rounded-md shadow-lg z-50 overflow-hidden",children:[e.jsxs("div",{className:"p-3 border-b border-secondary/10 bg-darkBg/80 flex items-center justify-between",children:[e.jsx("h3",{className:"font-montserrat font-semibold text-secondary",children:"Your Backpack"}),e.jsx("button",{onClick:()=>{a(!1),l("/profile")},className:"text-xs text-primary hover:text-primary/80 transition-colors",children:"View All"})]}),r.length===0?e.jsxs("div",{className:"p-4 text-center text-muted-foreground text-sm",children:[e.jsx(j,{className:"w-6 h-6 mx-auto mb-2 text-secondary/30"}),e.jsx("p",{children:"Your backpack is empty. Highlight important content during missions to save it here."})]}):e.jsxs("ul",{className:"max-h-[60vh] overflow-auto",children:[r.slice(0,5).map(s=>e.jsx("li",{className:"border-b border-secondary/5 last:border-0 hover:bg-secondary/5",children:e.jsx("button",{onClick:()=>{a(!1),l(`/realm/${s.realmId}/mission/${s.missionId}`)},className:"w-full text-left px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 mt-0.5 flex-shrink-0 rounded-full flex items-center justify-center",style:{backgroundColor:`${s.color}40`||"rgba(255, 204, 0, 0.2)"},children:e.jsx(g,{className:"w-4 h-4 text-secondary"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-lightText",children:[e.jsxs("span",{className:"font-medium",children:["Realm ",s.realmId]})," â€¢ Mission ",s.missionId]}),e.jsx("p",{className:"mt-1 text-lightText/90 font-mono text-xs py-1 px-2 bg-darkBg/50 rounded-sm",children:u(s.text)}),e.jsxs("p",{className:"text-xs text-lightText/60 mt-1 flex justify-between",children:[e.jsx("span",{children:h(s.timestamp)}),s.notes&&e.jsx("span",{className:"italic",children:"Has notes"})]})]})]})})},s.id)),r.length>5&&e.jsx("li",{className:"border-t border-secondary/10 bg-muted/10",children:e.jsxs("button",{onClick:()=>{a(!1),l("/profile")},className:"w-full py-2 text-sm text-secondary hover:text-primary",children:["View all ",r.length," items"]})})]})]})]})}function w({className:m=""}){const[o,a]=p(),{user:t,userProfile:n,logout:l}=f(),r=(t==null?void 0:t.username)||"Guest",d=(t==null?void 0:t.userId)||"",h=r.charAt(0).toUpperCase(),u=()=>{l(),a("/auth")};return e.jsx("header",{className:`bg-darkBg/90 backdrop-blur-sm border-b border-secondary/10 sticky top-0 z-50 ${m}`,children:e.jsxs("div",{className:"container mx-auto px-4 py-3 flex justify-between items-center",children:[e.jsx(c,{to:"/",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/asha-icon.svg",alt:"Asha's Journey Logo",className:"w-10 h-10 object-contain"}),e.jsx("h1",{className:"text-xl font-cinzel font-bold text-secondary hidden sm:block",children:"Asha's Journey"})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("nav",{className:"hidden md:flex items-center gap-6 mr-4",children:[e.jsx(c,{to:"/",children:e.jsx("span",{className:`text-sm font-medium ${o==="/"?"text-primary":"text-secondary hover:text-primary"} transition-colors`,children:"Home"})}),e.jsx(c,{to:"/map",children:e.jsx("span",{className:`text-sm font-medium ${o==="/map"?"text-primary":"text-secondary hover:text-primary"} transition-colors`,children:"Map"})}),e.jsx(c,{to:"/profile",children:e.jsx("span",{className:`text-sm font-medium ${o==="/profile"?"text-primary":"text-secondary hover:text-primary"} transition-colors`,children:"Profile"})})]}),e.jsx(y,{}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{to:"/profile",children:e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-secondary font-medium cursor-pointer hover:bg-primary/30 transition-colors",title:r,style:{backgroundColor:n!=null&&n.avatarColor?`${n.avatarColor}40`:"rgba(255, 204, 0, 0.2)"},children:h})}),e.jsxs("div",{className:"hidden sm:flex flex-col leading-tight",children:[e.jsx("span",{className:"text-sm text-secondary",children:r}),d&&e.jsxs("span",{className:"text-xs text-lightText/50",children:["ID: ",d]})]}),e.jsxs("button",{onClick:u,className:"ml-2 text-xs text-secondary/50 hover:text-secondary",title:"Logout",children:[e.jsx("span",{className:"sr-only",children:"Logout"}),e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})]})]})]})]})})}export{w as N};
